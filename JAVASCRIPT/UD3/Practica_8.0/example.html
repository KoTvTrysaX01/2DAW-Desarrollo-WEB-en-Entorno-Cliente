<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Gestión de Usuarios (CRUD con JSON Server)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background-color: #f7f9fc;
            color: #333;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
        }

        form {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        input,
        button {
            padding: 10px;
            margin: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
        }

        th,
        td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        tr:hover {
            background-color: #f1f1f1;
        }

        button {
            cursor: pointer;
            border: none;
            border-radius: 5px;
        }

        .btn-editar {
            background-color: #3498db;
            color: white;
        }

        .btn-eliminar {
            background-color: #e74c3c;
            color: white;
        }
    </style>
</head>

<body>
    <h1>Gestión de Usuarios</h1>

    <!-- Formulario para agregar o editar usuarios -->
    <form id="usuarioForm">
        <input type="hidden" id="usuarioId">
        <input type="text" id="nombre" placeholder="Nombre" required>
        <input type="email" id="email" placeholder="Correo electrónico" required>
        <label>
            <input type="checkbox" id="activo"> Activo
        </label>
        <button type="submit">Guardar</button>
    </form>

    <!-- Tabla para mostrar los usuarios -->
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Email</th>
                <th>Activo</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody id="tablaUsuarios"></tbody>
    </table>

    <script>
        const API_URL = 'http://localhost:3000/usuarios';

        const tablaUsuarios = document.getElementById('tablaUsuarios');
        const form = document.getElementById('usuarioForm');
        const idInput = document.getElementById('usuarioId');
        const nombreInput = document.getElementById('nombre');
        const emailInput = document.getElementById('email');
        const activoInput = document.getElementById('activo');

        //  Leer (GET) 
        async function cargarUsuarios() {
            const respuesta = await fetch(API_URL);
            const usuarios = await respuesta.json();

            tablaUsuarios.innerHTML = '';
            usuarios.forEach(usuario => {
                const fila = document.createElement('tr');
                fila.innerHTML = ` 
          <td>${usuario.id}</td> 
          <td>${usuario.nombre}</td> 
          <td>${usuario.email}</td> 
          <td>${usuario.activo ? 'Si' : 'No'}</td> 
          <td> 
            <button class="btn-editar" onclick="editarUsuario(${usuario.id})">Editar</button> 
            <button class="btn-eliminar" onclick="eliminarUsuario(${usuario.id})">Eliminar</button> 
          </td> 
        `;
                tablaUsuarios.appendChild(fila);
            });
        }

        // Crear o Actualizar 
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = idInput.value;
            const nombre = nombreInput.value.trim();
            const email = emailInput.value.trim();
            const activo = activoInput.checked;

            const usuario = { nombre, email, activo };

            if (id) {
                // Actualizar (PUT) 
                await fetch(`${API_URL}/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ id: Number(id), ...usuario })
                });
            } else {
                // Crear (POST) 
                await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(usuario)
                });
            }

            form.reset();
            idInput.value = '';
            cargarUsuarios();
        });

        // Editar (Carga los datos en el formulario) 
        async function editarUsuario(id) {
            const respuesta = await fetch(`${API_URL}/${id}`);
            const usuario = await respuesta.json();

            idInput.value = usuario.id;
            nombreInput.value = usuario.nombre;
            emailInput.value = usuario.email;
            activoInput.checked = usuario.activo;
        }

        //  Eliminar (DELETE) 
        async function eliminarUsuario(id) {
            if (confirm('¿Seguro que deseas eliminar este usuario?')) {
                await fetch(`${API_URL}/${id}`, { method: 'DELETE' });
                cargarUsuarios();
            }
        }
        // Cargar los usuarios al iniciar 
        cargarUsuarios(); 
    </script>
</body>

</html>